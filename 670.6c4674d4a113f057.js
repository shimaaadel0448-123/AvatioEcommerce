"use strict";(self.webpackChunkavatio=self.webpackChunkavatio||[]).push([[670],{4670:(y,s,a)=>{a.r(s),a.d(s,{CheckoutComponent:()=>v});var l=a(2881),p=a(8032),c=a.n(p),d=a(4341),e=a(1360),u=a(3768),m=a(7643);let h=(()=>{class r{http;constructor(t){this.http=t}placeOrder(t){const o=localStorage.getItem("token"),n=new m.Lr({Authorization:`Bearer ${o}`,"Content-Type":"application/json"});return this.http.post("/order/place_order_api/",t,{headers:n})}static \u0275fac=function(o){return new(o||r)(e.KVO(m.Qq))};static \u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const f=["checkoutForm"];function g(r,b){if(1&r&&(e.j41(0,"div",35),e.nrm(1,"img",36),e.j41(2,"div")(3,"div",37),e.EFF(4),e.k0s(),e.j41(5,"small"),e.EFF(6),e.k0s()()()),2&r){const t=b.$implicit;e.R7$(),e.Y8G("src",t.product_image,e.B4B),e.R7$(3),e.JRh(t.product.product_name),e.R7$(2),e.Lme("",t.quantity," x $",t.product_price,"")}}let v=(()=>{class r{cartService;order;cartProducts=[];subTotal=0;tax=0;total=0;checkoutForm;constructor(t,o){this.cartService=t,this.order=o}ngOnInit(){this.cartService.getAllCartItems().subscribe({next:t=>{this.cartProducts=t.results,console.log(this.cartProducts),this.calculateTotals()},error:()=>{c().fire("Error","Failed to load cart data.","error")}})}calculateTotals(){this.total=this.cartProducts.reduce((t,o)=>t+o.total,0),this.tax=this.cartProducts.reduce((t,o)=>t+o.tax_amount,0)}onSubmit(){const t=this.checkoutForm.value;this.checkoutForm.valid&&(this.order.placeOrder({first_name:t.firstName,last_name:t.lastName,address_line_1:t.address1,address_line_2:t.address2,email:t.email,city:t.city,country:t.country,phone:t.phone,order_note:t.note,payment_method:t.paymentMethod,state:t.state}).subscribe({next:n=>console.log(n)}),console.log(this.checkoutForm.value),c().fire("Success!","Your order has been placed.","success"))}static \u0275fac=function(o){return new(o||r)(e.rXU(u.m),e.rXU(h))};static \u0275cmp=e.VBU({type:r,selectors:[["app-checkout"]],viewQuery:function(o,n){if(1&o&&e.GBs(f,5),2&o){let i;e.mGM(i=e.lsd())&&(n.checkoutForm=i.first)}},decls:70,vars:5,consts:[["checkoutForm","ngForm"],[1,"checkout","container","my-4"],[1,"fw-bold","fs-2","text-center","mb-4"],[1,"row","g-4"],[1,"col-lg-7","col-md-12"],[1,"billing-details","p-4","rounded"],[1,"fw-bold","mb-4"],[3,"ngSubmit"],[1,"row","my-4"],[1,"col"],["type","text","name","firstName","ngModel","","placeholder","First Name","required","",1,"form-control",2,"padding","10px"],["type","text","name","lastName","ngModel","","placeholder","Last Name","required","",1,"form-control",2,"padding","10px"],[1,"my-4"],["type","email","name","email","ngModel","","placeholder","Email","required","",1,"form-control",2,"padding","10px"],["type","tel","name","phone","ngModel","","placeholder","Phone Number","required","",1,"form-control",2,"padding","10px"],["type","text","name","address1","ngModel","","placeholder","Address Line 1","required","",1,"form-control",2,"padding","10px"],["type","text","name","address2","ngModel","","placeholder","Address Line 2",1,"form-control",2,"padding","10px"],["type","text","name","state","ngModel","","placeholder","State","required","",1,"form-control",2,"padding","10px"],["type","text","name","city","ngModel","","placeholder","City","required","",1,"form-control",2,"padding","10px"],["type","text","name","country","ngModel","","placeholder","Country",1,"form-control",2,"padding","10px"],["name","note","ngModel","","placeholder","Order Notes (Optional)","rows","3",1,"form-control"],[1,"form-check","my-2"],["type","radio","name","paymentMethod","id","paypal","value","PayPal","ngModel","","required",""],["for","paypal",1,"form-check-label"],["type","radio","name","paymentMethod","id","stripe","value","Stripe","ngModel","","required",""],["for","stripe",1,"form-check-label"],["type","radio","name","paymentMethod","id","cod","value","Cash on Delivery","ngModel","","required",""],["for","cod",1,"form-check-label"],[1,"col-12","mt-4"],["type","submit",1,"btn","btn-dark","w-100","py-2","fs-5","fw-bold",3,"disabled"],[1,"col-lg-5","col-md-12"],[1,"order-summary","p-4","rounded"],["class","d-flex align-items-center mb-3",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","mb-2"],[1,"d-flex","justify-content-between","fw-bold","fs-5","mb-4"],[1,"d-flex","align-items-center","mb-3"],["alt","",1,"img-fluid","rounded","me-3",2,"width","80px","height","80px","object-fit","cover",3,"src"],[1,"fw-bold"]],template:function(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",1)(1,"h1",2),e.EFF(2,"Checkout"),e.k0s(),e.j41(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),e.EFF(7,"Billing Details"),e.k0s(),e.j41(8,"form",7,0),e.bIt("ngSubmit",function(){return e.eBV(i),e.Njj(n.onSubmit())}),e.j41(10,"div",8)(11,"div",9),e.nrm(12,"input",10),e.k0s(),e.j41(13,"div",9),e.nrm(14,"input",11),e.k0s()(),e.j41(15,"div",12),e.nrm(16,"input",13),e.k0s(),e.j41(17,"div",12),e.nrm(18,"input",14),e.k0s(),e.j41(19,"div",12),e.nrm(20,"input",15),e.k0s(),e.j41(21,"div",12),e.nrm(22,"input",16),e.k0s(),e.j41(23,"div",8)(24,"div",9),e.nrm(25,"input",17),e.k0s(),e.j41(26,"div",9),e.nrm(27,"input",18),e.k0s()(),e.j41(28,"div",12),e.nrm(29,"input",19),e.k0s(),e.j41(30,"div",12),e.nrm(31,"textarea",20),e.k0s(),e.j41(32,"h4",6),e.EFF(33,"Select Payment Method"),e.k0s(),e.j41(34,"div",21),e.nrm(35,"input",22),e.j41(36,"label",23),e.EFF(37,"PayPal"),e.k0s()(),e.j41(38,"div",21),e.nrm(39,"input",24),e.j41(40,"label",25),e.EFF(41,"Stripe"),e.k0s()(),e.j41(42,"div",21),e.nrm(43,"input",26),e.j41(44,"label",27),e.EFF(45,"Cash on Delivery"),e.k0s()(),e.j41(46,"div",28)(47,"button",29),e.EFF(48," Place Order "),e.k0s()()()()(),e.j41(49,"div",30)(50,"div",31)(51,"h4",6),e.EFF(52,"Order Summary"),e.k0s(),e.DNE(53,g,7,4,"div",32),e.j41(54,"div",33)(55,"span"),e.EFF(56,"Subtotal:"),e.k0s(),e.j41(57,"span"),e.EFF(58),e.k0s()(),e.j41(59,"div",33)(60,"span"),e.EFF(61,"Tax (2%):"),e.k0s(),e.j41(62,"span"),e.EFF(63),e.k0s()(),e.nrm(64,"hr"),e.j41(65,"div",34)(66,"span"),e.EFF(67,"Total"),e.k0s(),e.j41(68,"span"),e.EFF(69),e.k0s()()()()()()}if(2&o){const i=e.sdS(9);e.R7$(47),e.Y8G("disabled",!i.valid),e.R7$(6),e.Y8G("ngForOf",n.cartProducts),e.R7$(5),e.SpI("$",n.total,""),e.R7$(5),e.SpI("$",n.tax,""),e.R7$(6),e.SpI("$",n.total+n.tax,"")}},dependencies:[l.MD,l.Sq,d.YN,d.qT,d.me,d.Fm,d.BC,d.cb,d.YS,d.vS,d.cV],styles:[".billing-details[_ngcontent-%COMP%], .order-summary[_ngcontent-%COMP%]{background:var(--nav-bg);border-radius:10px;color:var(--text-color)}.order-summary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:8px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:none;outline:none;color:var(--text-color);background-color:var(--input-bg);padding:8px 12px;border-radius:6px;transition:border .2s ease;-webkit-transition:border .2s ease;-moz-transition:border .2s ease;-ms-transition:border .2s ease;-o-transition:border .2s ease}input[_ngcontent-%COMP%]::placeholder, textarea[_ngcontent-%COMP%]::placeholder{color:var(--text-color)}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{border:2px solid #007bff;outline:none;background-color:var(--input-bg)}"]})}return r})()}}]);